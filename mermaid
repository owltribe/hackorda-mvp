graph TD
    %% Frontend Components
    Profile["Profile Page<br/>/profile"]
    QuizStarter["Quiz Starter<br/>/quiz"]
    QuizSession["Quiz Session<br/>/quiz/[sessionId]"]
    QuizResults["Quiz Results<br/>/quiz/results/[sessionId]"]
    QuestionCard["Question Card Component"]

    %% Frontend Hooks
    ClerkHooks["Clerk Hooks<br/>useUser, useAuth"]
    StartQuizHook["useStartQuiz"]
    QuizQuestionsHook["useQuizSessionQuestions"]
    AnswerHook["useAnswerQuestion"]
    AbandonHook["useAbandonQuiz"]
    ResultsHook["useQuizResults"]
    sessionHook["Profile useEffect"]

    %% Backend API Routes
    APIStart["POST /api/quiz/start"]
    APIQuestions["GET /api/quiz/[sessionId]/questions"]
    APIAnswer["POST /api/quiz/answer"]
    APIAbandon["POST /api/quiz/abandon"]
    APIResults["GET /api/quiz/results/[sessionId]"]
    APIsession["GET /api/users/[userId]/quiz-session"]
    APIWebhook["POST /api/webhooks/clerk"]

    %% Database Tables
    DBUsers["Users Table"]
    DBQuestions["Questions Table"]
    DBModules["Question Modules Table"]
    DBsession["Quiz session Table"]
    DBAnswers["Quiz Answers Table"]

    %% External Service
    Clerk["Clerk Auth Service"]

    %% Frontend Component Relationships
    Profile --> ClerkHooks
    Profile --> sessionHook
    QuizStarter --> StartQuizHook
    QuizSession --> QuizQuestionsHook
    QuizSession --> QuestionCard
    QuizSession --> AnswerHook
    QuizSession --> AbandonHook
    QuizResults --> ResultsHook

    %% Hook to API Relationships
    ClerkHooks --> Clerk
    StartQuizHook --> APIStart
    QuizQuestionsHook --> APIQuestions
    AnswerHook --> APIAnswer
    AbandonHook --> APIAbandon
    ResultsHook --> APIResults
    sessionHook --> APIsession

    %% API to Database Relationships
    APIStart --> DBUsers
    APIStart --> DBQuestions
    APIStart --> DBsession
    APIQuestions --> DBQuestions
    APIQuestions --> DBsession
    APIAnswer --> DBAnswers
    APIAnswer --> DBsession
    APIAbandon --> DBsession
    APIResults --> DBsession
    APIResults --> DBAnswers
    APIsession --> DBsession
    APIsession --> DBUsers

    %% Clerk Integration
    Clerk --> APIWebhook
    APIWebhook --> DBUsers

    %% Styling
    classDef component fill:#f9f,stroke:#333,stroke-width:2px
    classDef hook fill:#bbf,stroke:#333,stroke-width:2px
    classDef api fill:#bfb,stroke:#333,stroke-width:2px
    classDef db fill:#fbb,stroke:#333,stroke-width:2px
    classDef external fill:#fff,stroke:#333,stroke-width:2px

    class Profile,QuizStarter,QuizSession,QuizResults,QuestionCard component
    class ClerkHooks,StartQuizHook,QuizQuestionsHook,AnswerHook,AbandonHook,ResultsHook,sessionHook hook
    class APIStart,APIQuestions,APIAnswer,APIAbandon,APIResults,APIsession,APIWebhook api
    class DBUsers,DBQuestions,DBModules,DBsession,DBAnswers db
    class Clerk external